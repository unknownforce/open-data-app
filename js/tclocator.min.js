$(document).ready(function(){var a=[];if(document.getElementById("map")){var c={center:new google.maps.LatLng(45.424871,-75.699706),zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP};var g=new google.maps.Map(document.getElementById("map"),c);var e;$(".results > ol > li").each(function(){var k=$(this).find("a").html();var m='<div class="info-window"><strong>'+k+'</strong><p><a href="single.php?id='+$(this).attr("data-id")+'">Rate or Comment!</a><p></div>';var n=parseFloat($(this).find('meta[itemprop="latitude"]').attr("content"));var l=parseFloat($(this).find('meta[itemprop="longitude"]').attr("content"));var h=new google.maps.LatLng(n,l);a.push({id:$(this).attr("data-id"),latitude:n,longitude:l});var i=new google.maps.Marker({position:h,map:g,title:k,icon:"images/tcl-icon.png",animation:google.maps.Animation.DROP});function j(o){if(o.preventDefault){o.preventDefault();}if(e){e.close();}e=new google.maps.InfoWindow({content:m});e.open(g,i);}google.maps.event.addListener(i,"click",j);google.maps.event.addDomListener($(this).get(0),"click",j);});}var d=$(".tennis-rating li");d.on("mouseenter",function(j){var k=$(this).index();for(var h=0;h<k;h++){d.eq(h).addClass("rated-hover");}}).on("mouseleave",function(h){d.removeClass("rated-hover");});var b;function f(q,h){var s=[],l=a.length,r=new google.maps.LatLng(q,h);if(b){b.setPosition(r);}else{b=new google.maps.Marker({position:r,map:g,title:"You are Here.",icon:"images/tcl-user.png",animation:google.maps.Animation.DROP});}g.setCenter(r);var o=new LatLon(q,h);for(var n=0;n<l;n++){s.push({id:a[n].id,distance:parseFloat(o.distanceTo(new LatLon(a[n].latitude,a[n].longitude)))});}s.sort(function(j,i){return j.distance-i.distance;});var k=$(".results > ol");for(var m=0;m<l;m++){var p=k.find('[data-id="'+s[m].id+'"]');p.find(".distance").html(s[m].distance.toFixed(1)+" km");k.append(p);}}if(navigator.geolocation){$("#geo").click(function(){navigator.geolocation.getCurrentPosition(function(h){f(h.coords.latitude,h.coords.longitude);});});}$("#geo-form").on("submit",function(h){h.preventDefault();var i=new google.maps.Geocoder();i.geocode({address:$("#address").val()+", Ottawa, ON",region:"CA"},function(k,j){if(j==google.maps.GeocoderStatuse.OK){f(k[0].geometry.location.latitude(),k[0].geometry.location.longitude());}});});});